<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: #0b0b0b;
    font-family: Arial, Helvetica, sans-serif;
}

#app {
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 1.5vh;
}

/* Encabezados */
h1 {
    color: white;
    font-weight: 900;
    font-size: clamp(20px, 6vw, 40px);
    margin: 0;
    text-align: center;
}

h2 {
    color: #ccc;
    font-weight: 700;
    font-size: clamp(14px, 4vw, 24px);
    margin: 0;
    text-align: center;
}

/* Caja principal */
#estado {
    width: 90vw;
    height: 32vh;
    border-radius: 20px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-weight: 900;
    text-align: center;
    animation: pulse 2s infinite;
}

/* Texto principal */
#texto {
    font-size: clamp(28px, 9vw, 64px);
    color: black;
}

/* Texto secundario (OPEN / CLOSED) */
#subtexto {
    font-size: clamp(14px, 4vw, 24px);
    margin-top: 0.5vh;
    color: black;
}

/* Aviso bilingüe */
#aviso {
    margin-top: 1vh;
    font-size: clamp(12px, 3.5vw, 18px);
    font-weight: 600;
    line-height: 1.3;
    color: black;
}

/* Pie */
#meta {
    color: #ccc;
    font-size: clamp(12px, 3.5vw, 18px);
    text-align: center;
}

/* Animación */
@keyframes pulse {
    0%   { transform: scale(1); }
    50%  { transform: scale(1.04); }
    100% { transform: scale(1); }
}
</style>
</head>

<body>
<div id="app">

    <h1>ESTADO DEL DESPEGUE:</h1>
    <h2>TAKEOFF STATUS:</h2>

    <div id="estado">
        <div id="texto">CARGANDO…</div>
        <div id="subtexto"></div>
        <div id="aviso"></div>
    </div>

    <div id="meta">Última actualización: —</div>

</div>

<script>
async function cargarEstado() {
    const url =
    "https://docs.google.com/spreadsheets/d/1ZJ4mVkXZyUVBRXLeiSHI2gSOt7JdcYj92bfKtPujU3g/gviz/tq?tqx=out:json&gid=1147167472";

    try {
        const r = await fetch(url);
        const t = await r.text();
        const j = JSON.parse(t.substring(t.indexOf("{"), t.lastIndexOf("}") + 1));

        const estado = j.table.rows[0].c[0].v.toLowerCase();
        const actualizado = j.table.rows[1].c[0].v;

        const box = document.getElementById("estado");
        const texto = document.getElementById("texto");
        const sub = document.getElementById("subtexto");
        const aviso = document.getElementById("aviso");
        const meta = document.getElementById("meta");

        if (estado.includes("abierto")) {
            box.style.background = "linear-gradient(#1fe38c, #0a9b5a)";
            texto.innerText = "ABIERTO";
            sub.innerText = "OPEN";
            aviso.innerHTML = "Despegue autorizado<br>Takeoff allowed";
        } else {
            box.style.background = "linear-gradient(#c00000, #700000)";
            texto.innerText = "CERRADO";
            sub.innerText = "CLOSED";
            aviso.innerHTML = "Despegue NO autorizado<br>Takeoff NOT allowed";
        }

        meta.innerText = actualizado;

    } catch (e) {
        document.getElementById("texto").innerText = "ERROR";
        document.getElementById("subtexto").innerText = "";
        document.getElementById("aviso").innerText = "";
        document.getElementById("estado").style.background = "#777";
        document.getElementById("meta").innerText = "No se pudo leer el estado";
    }
}

cargarEstado();
setInterval(cargarEstado, 15000);
</script>
</body>
</html>
